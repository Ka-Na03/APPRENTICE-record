# 日報
その日に学んだ事や覚えておきたい事等を網羅的に書いていく。
## 本日の目標（TODO目標/できるようになりたいこと）
- 提出QUESTの完成を目指して頑張る
## 学習時間（Hour）
- １２時間以上？
## 目標振り返り（TODO進捗/できるようになりたいこと振り返り）
- Rubyをインストールする際にt2.microだとディスク容量の不足が起きる事がわかった
  - ruby-buildは/tmp配下にログ出力するみたい
  - 参考：[rubyインストールでtmpの容量不足 -Qiita](https://qiita.com/hoken/items/db6c1c86bccf4ebf9f21)
  - `TMPDIR="${PWD}/tmp" rbenv install 3.0.6`にする事で現在の作業ディレクトリに`tmp`ディレクトリを作成して、そのパスを`TMPDIR`環境変数にセット
  - 一時ディレクトリを作成し、そのディレクトリ内でRubyのインストールを行うようにしてディスク容量の不足をカバー
- rubyが入ったので、Gemパッケージからrailsをインストール
  - `gem update --system`
  - 異様に時間がかかったので、Ctrl+Cで一旦中止し`gem clean`して再度実行したらすんなり行けた。30分以上待ったのがバカみたい
- t2.microだと明らかにマシンスペックが足りない印象を受けた
  - 主にメモリ不足やディスク容量の不足が目立つ
- スワップ領域を作成して、メモリの不足を補う
- なんとかrailsアプリケーションが正しく実行できている状態までは来た
- ローカル環境でrailsのDBとRDSのDBの違いを解決する
  - Gemファイルに`gem "mysql2"`を追加して`bundle install`を実行する
  - 上記の工程でエラー、GPT-4に聞いてみるとmysql2 gemのネイティブ拡張がビルドされる際に問題が発生したとか...
  - MySQL Connector/Cをダウンロードしてインストールし、環境変数PATHにMySQL Connector/Cのbinディレクトリがあるか確認し、mysql2 gemをインストールディレクトリをConnector/Cに指定してインストールする。
  - 何がなんだかよく分からなかったので少し調べたら、MySQL8.0にはC APIがC++に含まれていて環境変数PATHを設定し、mysql2のgemをインストールすればいいのがわかった
  - インストールする際にかなり詰まって最終的にこのコマンドで解決した `gem install mysql2 --platform=ruby -- --with-mysql-dir="C:\Program Files\MySQL\Connector C++ 8.0" --with-mysql-lib="C:\Program Files\MySQL\Connector C++ 8.0\lib64"`
  - 詰まった原因はディレクトリの指定で`lib64`まで指定しないといけなかった
- `config/database.yml`を編集し`rails db:create`でデータベースを作成しようとしたが、rootユーザーのパスワードではじかれた、環境変数でMySQLのパスワードを設定`$env:DB_PASSWORD="パスワード"`
- `rails db:migrate`で変更を反映して、gitにプッシュ、ここからデプロイ
- EC2インスタンス上で`git clone`して、EC2インスタンスの環境変数を設定するところでツムツム
  - 出来たと思って`rails db:create`をしたがproduction環境で秘密鍵が設定されていないからダメよ～っていわれた
  - 秘密鍵を作ろうと`budle exec rake secret`をしてエディタを開いて設定をしようとしたが、`ruby.exe`が見つからない
  - `which ruby`で実行ファイルのパスを出力したら普通にある、ここでまたもや`環境変数`が壁になる
- EC2インスタンスにrubyを導入した時に一時ディレクトリを作成してそこにRubyをインストールしたが、それもなんか関係ありそう

## 詰まっていること（実現したいこと/現状/行ったこと/仮説）
- EC2の処理が重い。ソフトウェアのインストールやgemの更新に思っている以上に時間がかかる

## 学んだこと（新しい気付き、学び）
- 学習コストをケチらない（改めて）
- 作業内容や手順、コマンドライン等をめっちゃメモる、ついでに日報にも書くとなんかやってる感出て自己肯定感アゲ ＝ モチベが上がる

## 感想（一日の感想、雑談）
- 今日は学習時間の計測をしてないが7/9 ～ 7/10にかけて生活リズムが崩壊するような学習をした
- 正直日報が上がらない日は学習している内容の記載範囲が日付を超えてさらに朝も超えると分からなくなるから

## 明日の目標（TODO目標/できるようになりたいこと）
- 一旦休憩したいところだけど、オリジナルプロダクトの機能要件とAWSの学習内容を改めて見やすい様にまとめる